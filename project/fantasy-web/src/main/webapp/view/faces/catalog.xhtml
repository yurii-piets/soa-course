<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Catalog</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"/>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"/>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"/>
    <style>
        h1 {
            font-size: 25px;
        }

        h2 {
            font-size: 19px;
        }
    </style>
</head>
<h:body>
    <script type="text/javascript">
        function toogleDragons(id) {
            var element = document.getElementById('dr-' + id);
            if (element.style.display === 'block') {
                element.style.display = 'none';
            } else {
                element.style.display = 'block'
            }
        }
    </script>

    <h1>Caves</h1>
    <table class="table table-hover table-striped">
        <thead class="thead-dark">
        <tr>
            <th scope="col">#</th>
            <th scope="col">Type</th>
            <th scope="col">Square</th>
            <th scope="col">Dragons Amount</th>
            <th scope="col">Action</th>
        </tr>
        </thead>
        <tbody>
        <ui:repeat value="#{catalogBean.caves}" var="cave">
            <tr onclick="toogleDragons('#{cave.id}')">
                <th scope="row">#{cave.id}</th>
                <td>Cave</td>
                <td><h:outputText value="#{cave.square}"/></td>
                <td><h:outputText value="#{fn:length(cave.dragons)}"/></td>
                <td>
                    <h:form>
                        <h:commandButton styleClass="btn btn-danger" value="Drop Category"
                                         action="#{dragonBean.deleteCave}">
                            <f:param name="caveId" value="#{cave.id}"/>
                        </h:commandButton>
                        <br/>
                    </h:form>
                </td>
            </tr>
        </ui:repeat>
        </tbody>
    </table>

    <ui:repeat value="#{catalogBean.caves}" var="cave">
        <table id="dr-#{cave.id}" class="table table-hover" style="display: none">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Gold</th>
                <th scope="col">Color</th>
                <th scope="col">Power</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            <ui:repeat value="#{cave.dragons}" var="dragon">
                <tr>
                    <th scope="row">#{dragon.id}</th>
                    <td><h:outputText value="#{dragon.name}"/></td>
                    <td><h:outputText value="#{dragon.gold}"/></td>
                    <td><h:outputText value="#{dragon.color}"/></td>
                    <td><h:outputText value="#{dragon.power}"/></td>
                    <td>
                        <h:form>
                            <h:commandButton styleClass="btn btn-success" value="Modify"
                                             action="#{dragonBean.modify}">
                                <f:param name="dragonId" value="#{dragon.id}"/>
                                <f:param name="name" value="#{dragon.name}"/>
                                <f:param name="gold" value="#{dragon.gold}"/>
                                <f:param name="color" value="#{dragon.color}"/>
                                <f:param name="power" value="#{dragon.power}"/>
                                <f:param name="caveId" value="#{cave.id}"/>
                            </h:commandButton>
                            <h:commandButton styleClass="btn btn-danger" value="Delete Dragon"
                                             action="#{dragonBean.delete}">
                                <f:param name="dragonId" value="#{dragon.id}"/>
                            </h:commandButton>
                        </h:form>
                    </td>
                </tr>
            </ui:repeat>
            </tbody>
        </table>
    </ui:repeat>
</h:body>
</html>
